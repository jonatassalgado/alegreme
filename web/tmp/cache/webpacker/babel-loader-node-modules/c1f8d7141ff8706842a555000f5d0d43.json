{"ast":null,"code":"var request = require('request');\n\nvar Promise = require('promise');\n\nfunction SDK(config) {\n  sdk = {};\n  sdk.config = config;\n\n  sdk.studioAPI = function (options) {\n    if (!sdk.config.studio_token || sdk.config.studio_token === null) {\n      throw new Error('No Botkit Studio Token');\n    }\n\n    var _STUDIO_COMMAND_API = sdk.config.studio_command_uri || 'https://api.botkit.ai';\n\n    options.uri = _STUDIO_COMMAND_API + options.uri;\n    return new Promise(function (resolve, reject) {\n      var headers = {\n        'content-type': 'application/json'\n      };\n      options.uri = options.uri + '?access_token=' + sdk.config.studio_token;\n      options.headers = headers;\n      request(options, function (err, res, body) {\n        if (err) {\n          return reject(err);\n        }\n\n        var json = null;\n\n        try {\n          json = JSON.parse(body);\n        } catch (e) {\n          return reject('Invalid JSON received from Botkit Studio API');\n        }\n\n        if (!json || json == null) {\n          reject('Botkit Studio API response was empty or invalid JSON');\n        } else if (json.error) {\n          if (res.statusCode === 401) {\n            console.error(json.error);\n          }\n\n          reject(json.error);\n        } else {\n          resolve(json);\n        }\n      });\n    });\n  };\n\n  sdk.identify = function () {\n    var url = '/api/v2/bots/identify';\n    return sdk.studioAPI({\n      uri: url,\n      method: 'get',\n      form: {}\n    });\n  };\n\n  sdk.evaluateTrigger = function (text, user) {\n    var url = '/api/v1/commands/triggers';\n    return sdk.studioAPI({\n      uri: url,\n      method: 'post',\n      form: {\n        triggers: text,\n        user: user\n      }\n    });\n  };\n\n  sdk.getScript = function (text, user) {\n    var url = '/api/v1/commands/name';\n    return sdk.studioAPI({\n      uri: url,\n      method: 'post',\n      form: {\n        command: text,\n        user: user\n      }\n    });\n  };\n\n  sdk.getScriptById = function (id, user) {\n    var url = '/api/v1/commands/id';\n    return sdk.studioAPI({\n      uri: url,\n      method: 'post',\n      form: {\n        id: id,\n        user: user\n      }\n    });\n  };\n\n  sdk.getScripts = function (tag) {\n    var url = '/api/v1/commands/list';\n\n    if (tag) {\n      url = url + '?tag=' + tag;\n    }\n\n    return sdk.studioAPI({\n      uri: url,\n      method: 'get'\n    });\n  };\n\n  sdk.createScript = function (trigger, text) {\n    var url = '/api/v1/commands/create';\n    return sdk.studioAPI({\n      uri: url,\n      method: 'post',\n      form: {\n        trigger: trigger,\n        answer: text\n      }\n    });\n  };\n\n  return sdk;\n}\n\nmodule.exports = SDK;","map":null,"metadata":{},"sourceType":"module"}