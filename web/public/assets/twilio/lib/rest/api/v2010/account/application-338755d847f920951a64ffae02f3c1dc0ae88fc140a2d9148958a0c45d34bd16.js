"use strict";var ApplicationList,ApplicationPage,ApplicationInstance,ApplicationContext,Q=require("q"),_=require("lodash"),Page=require("../../../../base/Page"),deserialize=require("../../../../base/deserialize"),serialize=require("../../../../base/serialize"),values=require("../../../../base/values");ApplicationList=function(t,e){function i(t){return i.get(t)}return i._version=t,i._solution={accountSid:e},i._uri=_.template("/Accounts/<%= accountSid %>/Applications.json")(i._solution),i.create=function(t,e){if(_.isUndefined(t))throw new Error('Required parameter "opts" missing.');if(_.isUndefined(t.friendlyName))throw new Error('Required parameter "opts.friendlyName" missing.');var i=Q.defer(),o=values.of({FriendlyName:_.get(t,"friendlyName"),ApiVersion:_.get(t,"apiVersion"),VoiceUrl:_.get(t,"voiceUrl"),VoiceMethod:_.get(t,"voiceMethod"),VoiceFallbackUrl:_.get(t,"voiceFallbackUrl"),VoiceFallbackMethod:_.get(t,"voiceFallbackMethod"),StatusCallback:_.get(t,"statusCallback"),StatusCallbackMethod:_.get(t,"statusCallbackMethod"),VoiceCallerIdLookup:serialize.bool(_.get(t,"voiceCallerIdLookup")),SmsUrl:_.get(t,"smsUrl"),SmsMethod:_.get(t,"smsMethod"),SmsFallbackUrl:_.get(t,"smsFallbackUrl"),SmsFallbackMethod:_.get(t,"smsFallbackMethod"),SmsStatusCallback:_.get(t,"smsStatusCallback"),MessageStatusCallback:_.get(t,"messageStatusCallback")}),n=this._version.create({uri:this._uri,method:"POST",data:o});return(n=n.then(function(t){i.resolve(new ApplicationInstance(this._version,t,this._solution.accountSid,this._solution.sid))}.bind(this)))["catch"](function(t){i.reject(t)}),_.isFunction(e)&&i.promise.nodeify(e),i.promise},i.each=function(t,e){function i(e){n=!0,_.isFunction(t.done)&&t.done(e)}function o(l){var r=l();_.isUndefined(r)?i():(r.then(function(l){_.each(l.instances,function(o){if(n||!_.isUndefined(t.limit)&&a>=t.limit)return n=!0,!1;a++,e(o,i)}),c.pageLimit&&c.pageLimit<=s?i():n||(s++,o(_.bind(l.nextPage,l)))}),r["catch"](i))}if(_.isFunction(t)&&(e=t,t={}),(t=t||{}).callback&&(e=t.callback),_.isUndefined(e))throw new Error("Callback function must be provided");var n=!1,s=1,a=0,c=this._version.readLimits({limit:t.limit,pageSize:t.pageSize});o(_.bind(this.page,this,_.merge(t,c)))},i.list=function(t,e){_.isFunction(t)&&(e=t,t={}),t=t||{};var i=Q.defer(),o=[];return t.callback=function(e,i){o.push(e),_.isUndefined(t.limit)||o.length!==t.limit||i()},t.done=function(t){_.isUndefined(t)?i.resolve(o):i.reject(t)},_.isFunction(e)&&i.promise.nodeify(e),this.each(t),i.promise},i.page=function(t,e){_.isFunction(t)&&(e=t,t={}),t=t||{};var i=Q.defer(),o=values.of({FriendlyName:_.get(t,"friendlyName"),PageToken:t.pageToken,Page:t.pageNumber,PageSize:t.pageSize}),n=this._version.page({uri:this._uri,method:"GET",params:o});return(n=n.then(function(t){i.resolve(new ApplicationPage(this._version,t,this._solution))}.bind(this)))["catch"](function(t){i.reject(t)}),_.isFunction(e)&&i.promise.nodeify(e),i.promise},i.getPage=function(t,e){var i=Q.defer(),o=this._version._domain.twilio.request({method:"GET",uri:t});return(o=o.then(function(t){i.resolve(new ApplicationPage(this._version,t,this._solution))}.bind(this)))["catch"](function(t){i.reject(t)}),_.isFunction(e)&&i.promise.nodeify(e),i.promise},i.get=function(t){return new ApplicationContext(this._version,this._solution.accountSid,t)},i},ApplicationPage=function(t,e,i){this._solution=i,Page.prototype.constructor.call(this,t,e,this._solution)},_.extend(ApplicationPage.prototype,Page.prototype),ApplicationPage.prototype.constructor=ApplicationPage,ApplicationPage.prototype.getInstance=function(t){return new ApplicationInstance(this._version,t,this._solution.accountSid)},ApplicationInstance=function(t,e,i,o){this._version=t,this.accountSid=e.account_sid,this.apiVersion=e.api_version,this.dateCreated=deserialize.rfc2822DateTime(e.date_created),this.dateUpdated=deserialize.rfc2822DateTime(e.date_updated),this.friendlyName=e.friendly_name,this.messageStatusCallback=e.message_status_callback,this.sid=e.sid,this.smsFallbackMethod=e.sms_fallback_method,this.smsFallbackUrl=e.sms_fallback_url,this.smsMethod=e.sms_method,this.smsStatusCallback=e.sms_status_callback,this.smsUrl=e.sms_url,this.statusCallback=e.status_callback,this.statusCallbackMethod=e.status_callback_method,this.uri=e.uri,this.voiceCallerIdLookup=e.voice_caller_id_lookup,this.voiceFallbackMethod=e.voice_fallback_method,this.voiceFallbackUrl=e.voice_fallback_url,this.voiceMethod=e.voice_method,this.voiceUrl=e.voice_url,this._context=undefined,this._solution={accountSid:i,sid:o||this.sid}},Object.defineProperty(ApplicationInstance.prototype,"_proxy",{get:function(){return this._context||(this._context=new ApplicationContext(this._version,this._solution.accountSid,this._solution.sid)),this._context}}),ApplicationInstance.prototype.remove=function(t){return this._proxy.remove(t)},ApplicationInstance.prototype.fetch=function(t){return this._proxy.fetch(t)},ApplicationInstance.prototype.update=function(t,e){return this._proxy.update(t,e)},ApplicationInstance.prototype.toJSON=function(){let t={};return _.forOwn(this,function(e,i){_.startsWith(i,"_")||_.isFunction(e)||(t[i]=e)}),t},(ApplicationContext=function(t,e,i){this._version=t,this._solution={accountSid:e,sid:i},this._uri=_.template("/Accounts/<%= accountSid %>/Applications/<%= sid %>.json")(this._solution)}).prototype.remove=function(t){var e=Q.defer(),i=this._version.remove({uri:this._uri,method:"DELETE"});return(i=i.then(function(t){e.resolve(t)}.bind(this)))["catch"](function(t){e.reject(t)}),_.isFunction(t)&&e.promise.nodeify(t),e.promise},ApplicationContext.prototype.fetch=function(t){var e=Q.defer(),i=this._version.fetch({uri:this._uri,method:"GET"});return(i=i.then(function(t){e.resolve(new ApplicationInstance(this._version,t,this._solution.accountSid,this._solution.sid))}.bind(this)))["catch"](function(t){e.reject(t)}),_.isFunction(t)&&e.promise.nodeify(t),e.promise},ApplicationContext.prototype.update=function(t,e){_.isFunction(t)&&(e=t,t={}),t=t||{};var i=Q.defer(),o=values.of({FriendlyName:_.get(t,"friendlyName"),ApiVersion:_.get(t,"apiVersion"),VoiceUrl:_.get(t,"voiceUrl"),VoiceMethod:_.get(t,"voiceMethod"),VoiceFallbackUrl:_.get(t,"voiceFallbackUrl"),VoiceFallbackMethod:_.get(t,"voiceFallbackMethod"),StatusCallback:_.get(t,"statusCallback"),StatusCallbackMethod:_.get(t,"statusCallbackMethod"),VoiceCallerIdLookup:serialize.bool(_.get(t,"voiceCallerIdLookup")),SmsUrl:_.get(t,"smsUrl"),SmsMethod:_.get(t,"smsMethod"),SmsFallbackUrl:_.get(t,"smsFallbackUrl"),SmsFallbackMethod:_.get(t,"smsFallbackMethod"),SmsStatusCallback:_.get(t,"smsStatusCallback"),MessageStatusCallback:_.get(t,"messageStatusCallback")}),n=this._version.update({uri:this._uri,method:"POST",data:o});return(n=n.then(function(t){i.resolve(new ApplicationInstance(this._version,t,this._solution.accountSid,this._solution.sid))}.bind(this)))["catch"](function(t){i.reject(t)}),_.isFunction(e)&&i.promise.nodeify(e),i.promise},module.exports={ApplicationList:ApplicationList,ApplicationPage:ApplicationPage,ApplicationInstance:ApplicationInstance,ApplicationContext:ApplicationContext};