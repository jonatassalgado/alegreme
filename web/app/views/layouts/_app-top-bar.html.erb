<%

 props = {
   visible: {
     backbutton:     ['show', 'neighborhood', 'follow', 'week'].include?(params[:action]) &&
                     mobile_device?,
     section_middle: (['feeds'].include?(params[:controller]) && !mobile_device?) ||
     ['search'].include?(params[:controller]),
     share_button:   content_for?(:share_button_url) && params[:action] == 'show' && mobile_device?,
     user_menu:      ['feeds'].include?(params[:controller]) && current_user,
     sign_up:        !current_user
   }
 }.deep_merge!(props || {})

 %>

<header class="me-top-app-bar mdc-top-app-bar <%= controller == 'events' ? 'me-top-app-bar--events' : '' %>" id="top-bar">
  <div class="mdc-top-app-bar__row">
    <!-- Section LEFT -->
    <section class="me-top-app-bar__section me-top-app-bar__section--left mdc-top-app-bar__section mdc-top-app-bar__section--align-start">

      <!-- Backbutton  -->
      <% if props[:visible][:backbutton] %>
        <button class="me-top-app-bar__back-button"
                onclick="window.AnimateModule.animateBackbutton()"
                style="">
            <div data-target="head.backButtonRipple" class="me-top-app-bar__back-button-ripple"></div>
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
              <path d="M20 11H6.83l2.88-2.88c.39-.39.39-1.02 0-1.41-.39-.39-1.02-.39-1.41 0L3.71 11.3c-.39.39-.39 1.02 0 1.41L8.3 17.3c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L6.83 13H20c.55 0 1-.45 1-1s-.45-1-1-1z"/>
            </svg>
        </button>
      <% end %>


      <!-- Logo -->
      <% if true  %>
        <a class="me-top-app-bar__logo is-hoverable" href="/feed">
          <svg xmlns="http://www.w3.org/2000/svg" width="120" height="28" fill="none" viewBox="0 0 120 28">
            <defs/>
            <path fill="#03994C" d="M118.172 19.5892c-.305.2615-1.538 1.7491-5.387 1.8299-4.099.086-7.589-3.493-7.595-7.0739-.164-10.58 12.469-10.4807 14.68-2.4524 0 0-9.082 3.7751-10.634 4.1844 0 0 1.044 2.387 3.701 2.3345 1.873-.0839 2.759-.7298 3.078-1.0412.791-.7695 1.619-.7079 2.29-.1869.658.5116.877 1.5391-.133 2.4056zm-2.451-8.8156c-.811-1.3714-2.732-2.1544-4.641-1.291-1.91.8634-2.694 2.5383-2.425 4.1126l7.066-2.8216zM80.5695 6.5924h3.6029v2.2293l.2345-.3625c.4491-.7001 1.0546-1.264 1.8162-1.6918.781-.4278 1.6402-.6413 2.5776-.6413 1.0936 0 2.0113.253 2.7534.7584.742.5059 1.2693 1.1278 1.5817 1.8667.4491-.7195 1.0838-1.332 1.904-1.8376.8201-.5252 1.816-.7875 2.9876-.7875.8788 0 1.6404.1455 2.2846.4379.645.2722 1.172.6613 1.582 1.1666.43.5052.752 1.118.967 1.8376.214.7001.322 1.4681.322 2.3043v9.0128h-3.8372v-8.3129c0-1.9444-.8006-2.9167-2.4018-2.9167-.5074 0-.9569.1168-1.3475.3504-.3907.2142-.7225.5152-.9958.9041-.2541.3698-.4592.8168-.6153 1.3418-.1367.5253-.2051 1.0889-.2051 1.6917v6.9419H89.943v-8.3128c0-1.9444-.8396-2.9168-2.519-2.9168-.4879 0-.9178.1168-1.2888.3504-.3713.2143-.6836.5152-.9373.9042-.2541.3697-.4491.8167-.5858 1.3418-.1368.5252-.2051 1.0889-.2051 1.6917v6.9419h-3.8372l-.0003-14.2936zM78.5716 17.4425c-.6642 1.1667-1.5622 2.1097-2.6948 2.8292-1.1131.7195-2.48 1.0793-4.1008 1.0793-1.0936 0-2.109-.1849-3.0464-.5539-.9177-.3891-1.7184-.9237-2.4018-1.6043-.6837-.6808-1.2205-1.4778-1.611-2.3917-.3714-.9334-.5563-1.9543-.5563-3.0627 0-1.0305.1857-2.0029.5563-2.9168.3713-.9333.8885-1.7403 1.5524-2.4209.6642-.7 1.445-1.2542 2.3433-1.6625.9178-.4085 1.9235-.6127 3.0171-.6127 1.1521 0 2.1773.1942 3.0755.5833.8983.3698 1.6501.8944 2.2555 1.575.6052.6614 1.0642 1.4487 1.3766 2.3626.3123.9139.4685 1.9057.4685 2.9751.0072.3325-.0359.6893-.0575.9917H67.9393c.0785.5833.2346 1.0889.4685 1.5168.254.4084.5562.7583.908 1.05.3713.2723.7713.4765 1.201.6126a5.0011 5.0011 0 001.3181.1749c.8787 0 1.6012-.1942 2.1676-.5833.5022-.3497 1.0554-1.0006 1.2265-1.2642.1713-.2637.4246-.1176.4246-.1176l2.918 1.4401zm-3.4856-5.542c-.0216-.2529-.1073-.5345-.2634-.8457-.1368-.311-.3519-.6027-.6448-.8751-.2734-.2723-.6246-.4959-1.0545-.6707-.4101-.1749-.9081-.2623-1.4939-.2623-.8201 0-1.5426.2336-2.1675.7-.6247.4666-1.0643 1.1181-1.3182 1.9543l6.9423-.0005zM54.1313 6.5922h3.6028v2.4553l.2346-.4722c.1756-.3497.4102-.6707.7031-.9625a5.191 5.191 0 01.9666-.7584 5.1663 5.1663 0 011.1716-.4958c.4296-.1169.8495-.1749 1.2595-.1749.508 0 .9374.0502 1.2889.1455.3713.0974.6836.2235.9373.379l-1.0252 3.471c-.2346-.1168-.4979-.2042-.7909-.2623-.2734-.078-.6153-.1167-1.0252-.1167-.5275 0-1.0056.1067-1.4352.321-.4296.1942-.8007.4764-1.1131.8458-.2929.3697-.5275.807-.7031 1.3126-.1561.4858-.2346 1.0209-.2346 1.6042v7.0002h-3.8371V6.5922zM44.2508 27.651c-1.0154 0-1.9235-.1361-2.7241-.4084-.7811-.2529-1.4645-.5933-2.0503-1.0209-.5858-.4084-1.0741-.8653-1.4646-1.3708-.3908-.5059-.6736-1.0112-.8495-1.5168-.8641-2.4535 2.6355-3.4465 3.6614-1.4583.2735.7583.7225 1.3417 1.3474 1.75.6246.4278 1.3182.6421 2.0797.6421 1.2108 0 2.1676-.3791 2.8706-1.1376.703-.7389 1.0545-1.7792 1.0545-3.1209l.0144-1.3336-.2504.3418c-.4491.622-1.0448 1.1181-1.7869 1.4876-.7224.3496-1.5816.5252-2.5776.5252-.8592 0-1.6988-.1748-2.519-.5252-.8007-.3497-1.5134-.8459-2.1383-1.4876-.6247-.6614-1.1326-1.4487-1.5232-2.3626-.3908-.914-.5858-1.9348-.5858-3.0626 0-1.1278.195-2.1487.5858-3.0626.3907-.9334.8983-1.721 1.5232-2.3626.6246-.6614 1.3376-1.1667 2.1383-1.5167.8201-.3505 1.6598-.5253 2.519-.5253.9959 0 1.8551.185 2.5776.554.7421.3504 1.3377.8361 1.7869 1.4584l.2346.3167V6.5919h3.6614v13.2713c0 1.2056-.1856 2.2848-.5562 3.2376-.3714.9722-.8886 1.789-1.5525 2.4501-.6642.6807-1.4646 1.1959-2.4019 1.5459-.9178.3697-1.943.5539-3.0756.5539l.0011.0003zm.1468-10.0628c.4684 0 .9276-.0875 1.3767-.2623.4685-.1748.8787-.4278 1.2303-.7584.3511-.3497.6347-.7681.8494-1.2542.2152-.5052.3224-1.0792.3224-1.7209 0-.6421-.1072-1.2153-.3224-1.7209-.2144-.5052-.498-.9237-.8494-1.2542-.3519-.3504-.7617-.6127-1.2303-.7876-.449-.1748-.908-.2623-1.3767-.2623-.4685 0-.9276.0875-1.3767.2623-.449.1748-.8495.4371-1.2009.7875-.3519.3504-.6347.7778-.8495 1.2834-.2145.4858-.3224 1.05-.3224 1.6917 0 .6421.1072 1.2154.3224 1.7209.2151.4858.4979.9043.8495 1.2542a3.6963 3.6963 0 001.2009.7584c.4491.1748.908.2624 1.3767.2624zM34.808 17.4425c-.6642 1.1667-1.5622 2.1097-2.6949 2.8292-1.1131.7195-2.4799 1.0793-4.1008 1.0793-1.0935 0-2.1089-.1849-3.0462-.5539-.9178-.3891-1.7185-.9237-2.4019-1.6043-.6837-.6808-1.2205-1.4778-1.6111-2.3917-.3713-.9334-.5562-1.9543-.5562-3.0627 0-1.0305.1856-2.0029.5562-2.9168.3714-.9333.8886-1.7403 1.5525-2.4209.6642-.7 1.445-1.2542 2.3433-1.6625.9178-.4085 1.9234-.6127 3.017-.6127 1.1522 0 2.1773.1942 3.0756.5833.8982.3698 1.6501.8944 2.2554 1.575.6052.6614 1.0643 1.4487 1.3768 2.3626.3123.9139.4684 1.9057.4684 2.9751.0144.3325-.036.6893-.0575.9917H24.1759c.0785.5833.2346 1.0889.4685 1.5168.254.4084.5563.7583.9081 1.05.3713.2723.7713.4765 1.2009.6126.4296.1168.869.1749 1.3181.1749.8788 0 1.6012-.1942 2.1676-.5833.5022-.3497 1.0554-1.0006 1.2266-1.2642.1712-.2637.4245-.1176.4245-.1176l2.9178 1.4401zm-3.4857-5.542c-.0216-.2529-.1072-.5345-.2634-.8457-.1367-.311-.3519-.6027-.6448-.8751-.2734-.2723-.6246-.4959-1.0544-.6707-.4102-.1749-.908-.2623-1.4938-.2623-.8202 0-1.5428.2336-2.1677.7-.6246.4666-1.0641 1.1181-1.318 1.9543l6.9421-.0005zM15.1907 20.8841V0h3.8371v20.8841h-3.8371zM9.6042 19.4049c.0148-.5184-.0097-.2705-.2329 0-.223.2705-.9895 1.0047-1.6297 1.3911-.621.3864-1.4261.5796-2.4156.5796-.7373 0-1.4358-.1256-2.0955-.3768-.6403-.2318-1.203-.5603-1.688-.9853-.485-.4251-.8634-.937-1.135-1.536C.1358 17.8786 0 17.2217 0 16.5068c0-.7342.1455-1.3911.4366-1.9707.291-.5989.6984-1.1109 1.2223-1.536.5239-.425 1.135-.7438 1.8335-.9564.718-.2318 1.494-.3477 2.3283-.3477.9313 0 1.6977.0773 2.2992.2318.6015.1353 1.0962.2802 1.4843.4347v-.4347c0-.7535-.3008-1.3718-.9022-1.8548-.6015-.5023-1.3485-.7535-2.241-.7535-1.3194 0-2.435.5507-3.347 1.6519L.3493 9.0877C1.8626 7.1943 3.929 6.2476 6.5483 6.2476c2.2119 0 3.8999.5216 5.064 1.565 1.1642 1.024 1.7462 2.5503 1.7462 4.5789v8.5204H9.6042v-1.507zm-1.397-4.7529c-.4657-.1352-.9798-.2028-1.5425-.2028-.9119 0-1.62.2028-2.1246.6086-.485.3864-.7275.8694-.7275 1.449 0 .5796.2328 1.0433.6984 1.3911.4851.3477 1.038.5216 1.659.5216.5044 0 .97-.0869 1.397-.2608 1.961-1.0854 2.9275-2.7597.6402-3.5067z"/>
          </svg>
        </a>
      <% end %>
    </section>

    <!-- Section MIDDLE -->
    <% if props[:visible][:section_middle] %>
      <section class="me-top-app-bar__section me-top-app-bar__section--middle mdc-top-app-bar__section">
        <!-- Search input -->
        <div class="me-search-field me-search-field mdc-text-field mdc-text-field--with-leading"
             data-controller="search"
             data-target="search.search"
             data-turbolinks-permanent>
          <form action="/busca"
                method="get"
                name="search"
                style="width: 100%">
            <i class="material-icons mdc-text-field__icon">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
                <path fill="none" d="M0 0h24v24H0V0z"/>
                <path d="M15.5 14h-.79l-.28-.27c1.2-1.4 1.82-3.31 1.48-5.34-.47-2.78-2.79-5-5.59-5.34-4.23-.52-7.79 3.04-7.27 7.27.34 2.8 2.56 5.12 5.34 5.59 2.03.34 3.94-.28 5.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
              </svg>
            </i>
            <input autocomplete="false"
                   name="q"
                   class="mdc-text-field__input"
                   id="text-field-shape-one"
                   placeholder="O que vocÃª estÃ¡ buscando hoje?"
                   type="text"
                   data-target="search.input">
            <input class="me-button mdc-button"
                   type="submit" value="Buscar"
                   data-target="search.submit"
                   data-action="click->search#searching"/>
          </form>
        </div>
      </section>
    <% end %>

    <section class="me-top-app-bar__section me-top-app-bar__section--right mdc-top-app-bar__section mdc-top-app-bar__section--align-end">
      <% if props[:visible][:share_button] %>
          <amp-social-share
            type="system"
            class="custom-style"
            data-param-text="<%= content_for :share_button_text %>"
            data-param-url="<%= content_for :share_button_url %>"
            data-param-attribution="Alegreme"
            width="78"
            height="28">
            <span>Enviar</span>
            <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 0 24 24" width="24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M3.4 20.4l17.45-7.48c.81-.35.81-1.49 0-1.84L3.4 3.6c-.66-.29-1.39.2-1.39.91L2 9.12c0 .5.37.93.87.99L17 12 2.87 13.88c-.5.07-.87.5-.87 1l.01 4.61c0 .71.73 1.2 1.39.91z"/></svg>
          </amp-social-share>
      <% end %>

      <% if props[:visible][:user_menu] %>
        <% if current_user&.picture %>
          <%= link_to user_path(current_user) do %>
            <div class="me-top-app-bar__picture is-hoverable" style="background-image: url('<%= current_user.picture :small %>')"></div>
          <% end %>
        <% end %>
        <div style="flex-direction: row">
          <%= link_to current_user.first_name, user_path(current_user), class: "me-top-app-bar__name" %> <br>
          <%= link_to "Sair", destroy_user_session_path, method: :delete, class: "me-top-app-bar__logout" %>
        </div>
      <% end %>

      <% if props[:visible][:sign_up] %>
        <% if !['registrations', 'sessions'].include? controller_name %>
          <%= link_to new_user_registration_path do %>
            <button class="me-button me-button--small mdc-button">Criar conta</button>
          <% end %>
        <% end %>
      <% end %>
    </section>

  </div>
</header>
