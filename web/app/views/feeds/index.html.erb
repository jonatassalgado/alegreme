<%= render Modal::SignInComponent.new(text: nil) %>


<div data-controller="loader"
		 data-loader-on-loading="horizontal-event#open-event:before"
		 data-loader-on-loaded="horizontal-event#open-event:success"
		 class="sticky top-20 z-10 z-50 px-5 mx-auto">
	<div id="open-event"
			 data-loader-target="loaded">
		<%= render MainSidebar::LargeEventComponent.new(user: current_user, event: nil) %>
	</div>
	<div
		class="flex hidden overscroll-contain fixed top-0 left-0 justify-center items-center w-screen h-screen text-3xl text-gray-800 rounded-xl shadow-lg font-display"
		data-loader-target="loading"
		style="background: #abacbfeb">
		Carregando
		<svg data-loader-target="onIcon" class="ml-2 w-5 h-5 fill-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
			<path fill="none" d="M0 0h24v24H0V0z"/>
			<path d="M17.65 6.35c-1.63-1.63-3.94-2.57-6.48-2.31-3.67.37-6.69 3.35-7.1 7.02C3.52 15.91 7.27 20 12 20c3.19 0 5.93-1.87 7.21-4.56.32-.67-.16-1.44-.9-1.44-.37 0-.72.2-.88.53-1.13 2.43-3.84 3.97-6.8 3.31-2.22-.49-4.01-2.3-4.48-4.52C5.31 9.44 8.26 6 12 6c1.66 0 3.14.69 4.22 1.78l-1.51 1.51c-.63.63-.19 1.71.7 1.71H19c.55 0 1-.45 1-1V6.41c0-.89-1.08-1.34-1.71-.71l-.64.65z"/>
		</svg>
	</div>
</div>

<div id="main-content" class="gap-16 mx-auto max-w-screen-lg md:grid md:grid-cols-8">
	<section id="main-sidebar" class="pt-12 space-y-16 col-span-8 md:col-span-5">
		<div class="space-y-16 mx-auto is-animated sm:container">
			<% if notice %>
				<div class="flex items-center p-3 mx-4 mt-1 mb-3 space-x-2 max-w-screen-lg text-sm font-semibold rounded-lg border bg-brand-100 border-brand-200 md:mb-0 md:mt-5 text-brand-600">
					<div class="flex flex-shrink-0 justify-center items-center mx-auto w-12 h-12 rounded-full bg-brand-100 sm:mx-0 sm:h-10 sm:w-10">
						<!-- Heroicon name: exclamation -->
						<svg class="w-6 h-6 text-brand-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
						</svg>
					</div>
					<div>
						<%= notice %>
					</div>
				</div>
			<% end %>
			<% unless params[:day] || params[:category] %>
				<% unless current_user %>
				<div id="hero__presentation" data-turbo-permanent class="flex flex-row-reverse gap-4 items-start md:flex md:flex-row md:mx-0 md:px-5 mx-5 select-none tap-highlight-none" style="min-height: <%= mobile_device? ? '150px' : '185px' %>">
					<div class="my-auto">
						<h2 class="c-h2">
							Eventos e Cinema em Porto Alegre
						</h2>
						<span class="inline-block mt-2 c-span">
    						Descubra eventos e siga seus locais e artistas favoritos para não perder nada que acontece na cidade.
    					</span>
					</div>
					<%= image_pack_tag ["hero/bebendo.png", "hero/passeando.png", "hero/dancando.png", "hero/skate.png"].sample, class: 'h-32 md:h-auto md:w-44 my-auto w-32' %>
				</div>
				<% end %>

				<!--				<div class="w-full h-60" style="background-image: url(<%#= asset_pack_url 'media/images/welcome/experiences.jpg' %>)">-->

				<!--				</div>-->

				<%= render Hero::SwipableComponent.new(user: current_user) %>
			<% end %>


			<% if @movies.present? && controller_name == 'feeds' && action_name == 'index' && params[:category].blank? %>
				<div id="movies" class="py-3" data-controller="persist-horizontal-scroll slider" data-model="movie" data-slider-distance-value="400" data-persist-horizontal-scroll-value="0">
					<h2 class="px-5 c-h2">
						Cinemas de Porto Alegre
					</h2>
					<div class="relative md:px-5 mt-2">
						<div class="hidden absolute top-0 left-0 z-20 items-center w-2 h-full select-none md:flex bg-x-white-to-transparent">
							<div data-slider-target="left" data-action="click->slider#left" class="hidden -ml-1 bg-brand-200 cursor-pointer duration-200 hover:bg-brand-600 hover:text-white mt-14 my-auto rounded-full shadow-md text-brand-700 transition-colors">
								<svg class="p-2 w-10 h-10 fill-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="black">
									<path d="M0 0h24v24H0V0z" fill="none"/>
									<path d="M19 11H7.83l4.88-4.88c.39-.39.39-1.03 0-1.42-.39-.39-1.02-.39-1.41 0l-6.59 6.59c-.39.39-.39 1.02 0 1.41l6.59 6.59c.39.39 1.02.39 1.41 0 .39-.39.39-1.02 0-1.41L7.83 13H19c.55 0 1-.45 1-1s-.45-1-1-1z"/>
								</svg>
							</div>
						</div>
						<div class="hidden absolute top-0 right-0 z-20 items-center w-3 h-full select-none md:flex bg-x-transparent-to-white">
							<div data-slider-target="right" data-action="click->slider#right" class="-ml-7 bg-brand-200 cursor-pointer duration-200 hover:bg-brand-600 hover:text-white mt-14 my-auto rounded-full shadow-md text-brand-700 transition-colors">
								<svg class="p-2 w-10 h-10 fill-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="black">
									<path d="M0 0h24v24H0V0z" fill="none"/>
									<path d="M5 13h11.17l-4.88 4.88c-.39.39-.39 1.03 0 1.42.39.39 1.02.39 1.41 0l6.59-6.59c.39-.39.39-1.02 0-1.41l-6.58-6.6c-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41L16.17 11H5c-.55 0-1 .45-1 1s.45 1 1 1z"/>
								</svg>
							</div>
						</div>
						<div data-slider-target="scroller"
								 data-persist-horizontal-scroll-target="scroller"
								 class="py-3 scrollx">
							<div class="px-5 md:px-0 grid grid-flow-col gap-2 w-content grid-after-margin">
								<% @movies.each do |movie| %>
									<div class="flex flex-col w-24 transition-transform transform group md:hover:scale-105">
										<%= link_to cine_film_path(movie), class: 'flex flex-col', data: { 'turbo-preserve-scroll': true } do %>
											<%= image_tag shrine_image_url(movie, :small), {
												loading: :lazy,
												title:   movie.title,
												alt:     "Filme #{movie.title}",
												class:   'border shadow-sm group-hover:shadow bg-brand-100  object-center object-cover rounded',
												style:   'min-height: 130px',
												onerror: "this.style.opacity='0'"
											} rescue nil %>
											<%= tag.div limit_name_size(movie.title, 24), class: 'leading-tight mt-2 inline-block text-xs text-center font-semibold text-gray-800' %>
											<div class="mt-1 leading-tight text-center text-xxs"><%= movie.genres&.join(", ") %></div>
										<% end %>
									</div>
								<% end %>
							</div>
						</div>
					</div>
				</div>
			<% end %>
		</div>

		<div>
			<% if @upcoming_events.present? %>
				<div class="bg-white">
					<% if params[:category] %>
						<div class="flex justify-between items-center pr-5 md:pr-10">
							<h2 class="px-5 c-h2">
								<span class="underline text-brand-600"><%= @category&.details_display_name&.titleize %></span> em Porto
								Alegre
							</h2>
						</div>
					<% else %>
						<h2 class="px-5 c-h2">
							Eventos em Porto Alegre <%= I18n.l params[:day].to_date if params[:day] %>
						</h2>
					<% end %>
					<%= render MainSidebar::FilterComponent.new(session:           session.id,
																											params:            params,
																											show_filter_group: nil,
																											filters:           {
																												categories: params[:category] ? [Category::CATEGORIES.select { |hash| hash['url'] == params[:category] }.first['name']] : [],
																												date:       nil
																											}) %>
				</div>
			<% else %>
				<h2 class="px-5 text-xl font-bold text-gray-900 bg-white font-display">
					Não foram encontrados eventos em Porto
					Alegre <%= I18n.l params[:day].to_date if params[:day] %> <%= "na categoria #{@category&.details_display_name&.titleize}" if params[:category] %>
				</h2>
			<% end %>
			<%= render MainSidebar::GroupByDayListComponent.new(events: @upcoming_events, user: current_user, open_in_sidebar: true) %>
		</div>
	</section>
	<% unless mobile_device? %>
		<section class="hidden md:inline-block md:col-span-3 md:bg-white"
						 id="left-sidebar">
			<%= render LeftSidebar::CalendarComponent.new(events: @liked_events, start_date: Date.today, user: current_user, filter: false, indicators: @indicators) %>
		</section>
	<% end %>


	<div data-controller="install" data-install-native="true" data-install-target="button" class="flex fixed bottom-20 z-30 items-center w-full transition-transform transform translate-y-32 select-none tap-highlight-none">
		<span data-action="click->install#install" class="py-3 px-5 mx-auto font-bold text-white bg-white rounded-full shadow-lg bg-brand-500 w-content">
			Instalar aplicativo
		</span>
	</div>

</div>



