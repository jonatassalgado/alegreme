<div id="feed-tabs">
	<div id="feed-menu" class="w-full px-5 pt-4 scrollx"
			 data-controller="scroll-on-clicked"
			 data-scroll-on-clicked-init-selected="<%= selected_tab %>"
			 data-scroll-on-clicked-offset-left="24"
			 data-target="scroll-on-clicked.scroller">
		<div class="flex pr-32 space-x-3 w-content">
			<div data-controller="cable-ready"
					 data-cable-ready-perform="tab"
					 data-cable-ready-current-tab="suggestions"
					 data-action="click->cable-ready#perform click->scroll-on-clicked#scroll"
					 data-target="scroll-on-clicked.item"
					 data-scroll-on-clicked-selected="suggestions"
					 class="<%= class_names 'px-4 py-1 rounded-full h-content',
																	{'bg-white':                                              selected_tab != 'suggestions',
																	 'bg-green-50 text-green-600 border-2 border-green-300': selected_tab == 'suggestions'} %>">
				<div class="<%= class_names 'font-semibold text-base',
																		{'text-gray-700':  selected_tab != 'suggestions',
																		 'text-green-600': selected_tab == 'suggestions'} %>">
					Indicados para você
				</div>
				<div class="<%= class_names 'text-xs -mt-1',
																		{'text-gray-600':  selected_tab != 'suggestions',
																		 'text-green-600': selected_tab == 'suggestions'} %>">
					Com base no que você gostou
				</div>
			</div>
			<div data-controller="cable-ready"
					 data-cable-ready-perform="tab"
					 data-cable-ready-current-tab="places"
					 data-action="click->cable-ready#perform click->scroll-on-clicked#scroll"
					 data-target="scroll-on-clicked.item"
					 data-scroll-on-clicked-selected="places"
					 class="<%= class_names 'px-4 py-1 rounded-full h-content',
																	{'bg-white':                                              selected_tab != 'places',
																	 'bg-green-50 text-green-600 border-2 border-green-300': selected_tab == 'places'} %>">
				<div class="<%= class_names 'font-semibold text-base',
																		{'text-gray-700':  selected_tab != 'places',
																		 'text-green-600': selected_tab == 'places'} %>">
					Locais e organizadores
				</div>
				<div class="<%= class_names 'text-xs -mt-1',
																		{'text-gray-600':  selected_tab != 'places',
																		 'text-green-600': selected_tab == 'places'} %>">
					Que você segue
				</div>
			</div>
		</div>
	</div>
	<% if selected_tab == 'suggestions' %>
		<div id="suggested-events" class="grid w-full grid-flow-col gap-5 px-5 pt-3 pb-5 grid-after-margin scrollx">
			<%= render partial: 'feeds/vertical_event', collection: suggested_events, as: :event,
								 locals:  {
										 user: user,
										 opts: {
												 display_similar:  false,
												 remove_on_action: false
										 }
								 } %>
		</div>
	<% elsif selected_tab == 'places' %>
		<% if user.following_places_and_organizers.present? %>
			<div id="place-events" class="grid w-full grid-flow-col gap-3 px-5 pt-3 pb-5 grid-after-margin scrollx">
				<% user.following_places_and_organizers.filter { |f| f.events.active.present? }.each do |entity| %>
					<div class="bg-white flex flex-col group h-content p-3 relative rounded-lg shadow tap-highlight-none w-56">
						<a class="leading-tight font-medium text-gray-500" href="<%= link_to_follow entity %>">
							<%= entity.details_name %>
						</a>
						<div class="grid grid-cols-2 gap-2 mt-3">
							<% entity.events.active.not_ml_data.limit(4).each do |event| %>
								<div data-controller="ripple" class="h-content overflow-hidden relative ripple ripple-white rounded w-full">
									<div class="bg-gray-50 aspect-ratio-16/9"></div>
									<%= link_to event_path(event) do %>
										<%= image_tag shrine_image_url(event, :feed), {
												loading: :lazy,
												class:   'absolute cursor-pointer left-0 object-center object-cover top-0 w-full overflow-hidden',
												onerror: "this.style.opacity='0'"
										} %>
									<% end %>
								</div>
							<% end %>
						</div>
						<% if entity.events.active.not_ml_data.size > 4 %>
							<%= link_to "Ver todos os #{entity.events.active.not_ml_data.size} eventos", link_to_follow(entity), class: '-mb-3 -mx-3 mt-2 py-2 rounded-b-lg text-center text-green-500 text-sm' %>
						<% else %>
							<%= link_to "Ver eventos", link_to_follow(entity), class: '-mb-3 -mx-3 mt-2 py-2 rounded-b-lg text-center text-green-500 text-sm' %>
						<% end %>
					</div>
				<% end %>
			</div>
		<% else %>
			<div class="leading-tight mt-4 px-5 text-gray-800 text-sm">
				Você ainda não segue locais e organizadores. Abaixo algumas sugestões:
			</div>
			<div id="place-events" class="grid w-full grid-flow-col gap-3 px-5 pt-3 pb-5 grid-after-margin scrollx">
				<% user.resources_from_liked_events[0..6].each do |resource| %>
					<div class="bg-white group h-content p-3 relative rounded-lg shadow tap-highlight-none w-56">
						<a class="leading-tight font-medium text-gray-600" href="<%= link_to_follow resource %>">
							<%= resource.details_name %>
						</a>
						<div class="grid grid-cols-2 gap-2 mt-3">
							<% resource.events.active.not_ml_data.limit(4).each do |event| %>
								<div data-controller="ripple" class="h-content overflow-hidden relative ripple ripple-white rounded w-full">
									<div class="bg-gray-50 aspect-ratio-16/9"></div>
									<%= link_to event_path(event) do %>
										<%= image_tag shrine_image_url(event, :feed), {
												loading: :lazy,
												class:   'absolute cursor-pointer left-0 object-center object-cover top-0 w-full overflow-hidden',
												onerror: "this.style.opacity='0'"
										} %>
									<% end %>
								</div>
							<% end %>
						</div>
						<div class="mt-3">
							<%= render partial: 'components/follow/follow_button', locals: {
									user:       user,
									followable: resource
							} %>
						</div>
					</div>
				<% end %>
			</div>
		<% end %>
	<% end %>
</div>